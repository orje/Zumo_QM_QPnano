[uml,Zumo_SD.png]
--

hide footbox

title Zumo sd


actor user
control Zumo
entity lcd
entity buttonA
control counter
control timetick
entity proxSensors
entity motors
entity encoders
entity ledGreen
entity ledYellow
entity ledRed


note over ledRed, user #EEEEEE

Als erstes //schalte// ich den **Zumo** ein.
Daraufhin //fordert// mich das **lcd** dazu auf, den **buttonA** zu drücken.
Wenn ich den **buttonA** gedrückt habe, erlischt das **lcd** und der **Zumo** setzt den **counter** auf //0// und startet einen **timetick**.
Dann tastet der **Zumo** mit den **proxSensors** sein Vorfeld ab, um zu checken, ob es //frei// ist.
Ist es //frei//, schaltet der **Zumo** die **grüne LED** ein und lässt die **motors** //vorwärts// fahren.
Während der Vorwärtsfahrt checkt und korrigiert der **Zumo** mit den **Encodern** den Gleichlauf der **motors**.
Erkennt der **Zumo** ein //Hindernis// in seinem Vorfeld, schaltet er die **gelbe LED** ein und dreht durch seine **motors** um //90°//.
Nach jedem Ablauf des **timetick**, checkt der **Zumo** sein Vorfeld und handelt entsprechend.
Erkennt der **Zumo** nach der //dritten// Drehung auf der Stelle immer noch ein Hindernis, schaltet der **Zumo** die **rote LED** ein 
und fordert auf dem **lcd** zum Drücken des **buttonA** auf.
Nach dem Betätigen des **buttonA** erlischt die **ledRed** und auf dem **lcd** erscheint wieder die Aufforderung zum Betätigen des **buttonA**.

end note


user -> Zumo : switched on
Zumo -> lcd : lcd.print(F("Press Start"));

user -> buttonA : pressed
buttonA -> Zumo : STARTSTOP_SIG
Zumo -> lcd : lcd.clear();
Zumo -> counter : counter = 0;
Zumo -> timetick : QActive_armX((QActive *)me,  \n 0U, BSP_TICKS_PER_SEC, 0U);

loop
alt no barrier
proxSensors -> Zumo : proxSensors.countsFrontWithLeftLeds() == 0 || \n proxSensors.countsFrontWithRightLeds() == 0;
Zumo -> ledGreen : ledGreen(1);
Zumo -> motors : motors.setSpeeds(400, 400);
Zumo -> encoders : correct drive;

else barrier
proxSensors -> Zumo : proxSensors.countsFrontWithLeftLeds() > 0 || \n proxSensors.countsFrontWithRightLeds() > 0;
Zumo -> ledYellow : ledYellow(1);
Zumo -> motors : motors.setSpeeds(100, 0);
Zumo -> counter : counter++;

else break
counter -> Zumo : counter == 3
Zumo -> ledRed : ledRed(1);
Zumo -> lcd : lcd.print(F("Press Stopp"));
end

user -> buttonA : pressed
buttonA -> Zumo : STARTSTOP_SIG
Zumo -> ledRed : ledRed(0);
Zumo -> lcd : lcd.print(F("Press Start"));

--