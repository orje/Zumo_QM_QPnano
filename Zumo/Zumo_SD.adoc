[uml,Zumo_sd.png]
--

hide footbox

title Zumo sd


actor user
entity Zumo
entity lcd
entity motors
control buttonA
control counter
control qp
control proxSensors
control encoders
control ledGreen
control ledYellow
control ledRed


user -> Zumo : switched on
Zumo -> lcd : DISPLAY_START_SIG

user -> buttonA : pressed
buttonA -> Zumo : BUTTON_PRESSED_SIG
Zumo -> lcd : DISPLAY_CLEAR_SIG
Zumo -> counter : RESET_COUNTER_SIG
Zumo -> qp : ARM_TIMER_SIG
Zumo -> proxSensors : CHECK_FRONT_SIG

loop
alt no barrier
proxSensors -> motors : DRIVE_SIG
motors -> encoders : CORRECT_DRIVE_SIG
proxSensors -> Zumo : DRIVE_SIG
Zumo -> ledGreen : GREEN_ON_SIG

else barrier
proxSensors -> motors : TURN_SIG
proxSensors -> Zumo : TURN_SIG
Zumo -> ledYellow : YELLOW_ON_SIG
Zumo -> motors : TURN_SIG // motors.setSpeeds(100, 0);
Zumo -> counter : counter++;

else break
counter -> Zumo : TRAPPED_SIG // counter == 3
Zumo -> ledRed : ledRed(1);
Zumo -> lcd : lcd.print(F("Press Stopp"));
end

user -> buttonA : pressed
buttonA -> Zumo : BUTTON_SIG
Zumo -> ledRed : ledRed(0);
Zumo -> lcd : lcd.print(F("Press Start"));


note over ledRed, user #EEEEEE

Als erstes schalte ich den **Zumo** ein.
Daraufhin fordert mich das **lcd** dazu auf, den **buttonA** zu drücken.
Wenn ich den **buttonA** gedrückt habe, erlischt das **lcd** und der **Zumo** setzt den **counter** auf 0 und startet einen **timetick**.
Dann tastet der **Zumo** mit den **proxSensors** sein Vorfeld ab, um zu checken, ob es frei ist.
Ist es frei, schaltet der **Zumo** die **grüne LED** ein und lässt die **motors** vorwärts fahren.
Während der Vorwärtsfahrt checkt und korrigiert der **Zumo** mit den **Encodern** den Gleichlauf der **motors**.
Erkennt der **Zumo** ein Hindernis in seinem Vorfeld, schaltet er die **gelbe LED** ein und dreht durch seine **motors** um 90°.
Nach jedem Ablauf des **timetick**, checkt der **Zumo** sein Vorfeld und handelt entsprechend.
Erkennt der **Zumo** nach der dritten Drehung auf der Stelle immer noch ein Hindernis, schaltet der **Zumo** die **rote LED** ein 
und fordert auf dem **lcd** zum Drücken des **buttonA** auf.
Nach dem Betätigen des **buttonA** erlischt die **ledRed** und auf dem **lcd** erscheint wieder die Aufforderung zum Betätigen des **buttonA**.

end note
